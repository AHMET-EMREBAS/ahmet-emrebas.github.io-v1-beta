<p-contextMenu #cm [model]="ds.contextMenuItems"></p-contextMenu>
<p-table #dt1 [value]="(entities$ | async)!" [columns]="ds.columns" responsiveLayout="scroll" [paginator]="true"
    [rows]="10" [rowsPerPageOptions]="[10,20,30, 50, 100]" paginatorPosition="bottom" [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" dataKey="id"
    styleClass="p-datatable-striped p-datatable-gridlines" [globalFilterFields]="ds.globalFilterFields"
    [selection]="true" [(selection)]="ds.selectedItems" (onFilter)="filterTable($event)" [contextMenu]="cm"
    [(contextMenuSelection)]="ds.selectedcontextItem" (onFilter)="filterTable($event)">


    <ng-template pTemplate="caption">
        <div class="flex gap-3">

            <p-button icon="pi pi-plus" styleClass="p-button-success" [routerLink]="['create']"></p-button>
            <div class="flex-grow-1"></div>

            <p-button icon="pi pi-trash" styleClass="p-button-danger" (click)="ds.deleteSelection()"
                *ngIf="ds.selectedItems.length > 0"></p-button>


            <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash"
                (click)="dt1.clear()"></button>

            <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input pInputText type="text" [formControl]="ds.searchControl"
                    (input)="dt1.filterGlobal(ds.searchControl.value, 'contains')" placeholder="Search keyword"
                    maxlength="100" />
            </span>
        </div>
    </ng-template>



    <ng-template pTemplate="header">
        <tr>

            <th style="width: 3rem">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
            </th>
            <th [class]="'th-' +col.field" *ngFor="let col of ds.columns" [pSortableColumn]="col.field">
                <div class="flex justify-content-center align-items-center">
                    {{col.header}}
                    <p-sortIcon [field]="col.field"></p-sortIcon>
                    <p-columnFilter type="text" [field]="col.field" display="menu"></p-columnFilter>
                </div>
            </th>

        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData>
        <tr [pContextMenuRow]="rowData">
            <td>
                <p-tableCheckbox [value]="{id:rowData.id}"></p-tableCheckbox>
            </td>
            <td [class]="'td-' + col.field" *ngFor="let col of ds.columns">{{rowData[col.field]}}</td>

        </tr>
    </ng-template>

</p-table>